library(readr)
insurance <- read_csv("insurance.csv")
View(insurance)
ds225 <- insurance
# Calculate correlation value
correlation_value <- cor(ds225$bmi, ds225$charges, method = "pearson")
correlation_value
# Correlation test
cor.test <- cor.test(ds225$bmi, ds225$charges, method = "pearson")
cor.test
# Scatter plot for BMI vs Charges
png("scatter_bmi_charges.png", width = 800, height = 500)
plot(ds225$bmi, ds225$charges,
main = "Scatterplot: BMI vs Charges",
xlab = "BMI",
ylab = "Charges",
pch = 19,
col = "blue")
abline(lm(charges ~ bmi, data = ds225), col = "red", lwd = 2)
dev.off()
df <- insurence
ds225 <- insurance
sum(is.na(ds225))
colSums(is.na(ds225))
df <- insurence
ds225 <- insurance
#Checking total missing values
sum(is.na(ds225))
#Checking missing values per column
colSums(is.na(ds225))
# Calculate correlation value
correlation_value <- cor(ds225$bmi, ds225$charges, method = "pearson")
correlation_value
# Correlation test
cor.test <- cor.test(ds225$bmi, ds225$charges, method = "pearson")
cor.test
# Scatter plot for BMI vs Charges
png("scatter_bmi_charges.png", width = 800, height = 500)
plot(ds225$bmi, ds225$charges,
main = "Scatterplot: BMI vs Charges",
xlab = "BMI",
ylab = "Charges",
pch = 19,
col = "blue")
abline(lm(charges ~ bmi, data = ds225), col = "red", lwd = 2)
dev.off()
library(readr)
insurance <- read_csv("insurance.csv")
View(insurance)
df <- insurence
ds225 <- insurance
#Checking total missing values
sum(is.na(ds225))
#Checking missing values per column
colSums(is.na(ds225))
# Detect outliers for BMI
BMI_outliers <- boxplot.stats(ds225$bmi)$out
BMI_outliers
# Detect outliers for charges
charges_outliers <- boxplot.stats(ds225$charges)$out
charges_outliers
boxplot(ds225$bmi, main = "Boxplot of BMI", ylab = "BMI")
boxplot(ds225$charges, main = "Boxplot of Charges", ylab = "Charges")
#Added new columns to flag outlier rows
ds225$BMI_outlier <- ds225$bmi %in% BMI_outliers
ds225$charges_outlier <- ds225$charges %in% charges_outliers
#Created new datasets without outliers
ds225_no_bmi_outliers <- ds225[!ds225$bmi %in% BMI_outliers, ]
ds225_no_charges_outliers <- ds225[!ds225$charges %in% charges_outliers, ]
#Summary before and after
summary(ds225$bmi)
summary(ds225$charges)
summary(ds225_no_charges_outliers$charges)
#Visual comparison of Box plots
png("Boxplot_of_charges_Outliers.png", width = 800, height = 500)
par(mfrow=c(1,2))
boxplot(ds225$charges, main="Before Removing Outliers", ylab = "Charges")
boxplot(ds225_no_charges_outliers$charges, main="After Removing Outliers", ylab = "Charges")
dev.off()
# Calculate correlation value
correlation_value <- cor(ds225$bmi, ds225$charges, method = "pearson")
correlation_value
# Correlation test
cor.test <- cor.test(ds225$bmi, ds225$charges, method = "pearson")
cor.test
#Histograms for BMI, charges
hist(ds225$bmi,
main = "Histogram of BMI",
xlab = "BMI",
col = "lightblue",
border = "black")
#Histogram for Charges
hist(ds225$charges,
main = "Histogram of Charges",
xlab = "Charges",
col = "lightgreen",
border = "black")
#Denisity plot for BMI
plot(density(ds225$bmi),
main = "Density Plot of BMI",
xlab = "BMI",
ylab = "Density")
#Density plot for Charges
plot(density(df$charges),
main = "Density Plot of Charges",
xlab = "Charges",
ylab = "Density")
#Shapiro test for BMI
shapiro.test(ds225$bmi)
#Denisity plot for BMI
plot(density(ds225$bmi),
main = "Density Plot of BMI",
xlab = "BMI",
ylab = "Density")
#Density plot for Charges
plot(density(ds225$charges),
main = "Density Plot of Charges",
xlab = "Charges",
ylab = "Density")
#Shapiro test for BMI
shapiro.test(ds225$bmi)
#Shapiro test for Charges
shapiro.test(ds225$charges)
# Scatter plot for BMI vs Charges
png("scatter_bmi_charges.png", width = 800, height = 500)
plot(ds225$bmi, ds225$charges,
main = "Scatterplot: BMI vs Charges",
xlab = "BMI",
ylab = "Charges",
pch = 19,
col = "blue")
abline(lm(charges ~ bmi, data = ds225), col = "red", lwd = 2)
dev.off()
par(mfrow = c(1,1))
plot(density(df$charges), main = "Density of Charges")
plot(density(ds225$bmi), main = "Density of BMI")
par(mfrow = c(2,2))
hist(ds225$bmi, main = "Histogram of BMI")
plot(density(ds225$bmi), main = "Density of BMI")
hist(ds225$charges, main = "Histogram of Charges")
plot(density(ds225$charges), main = "Density of Charges")
par(mfrow = c(1,1))
par(mfrow = c(1,1))
dev.off()
#Combined Visualization of Denity and Histogram plots for BMI and Charges
png("scatter_bmi_charges.png", width = 800, height = 500)
par(mfrow = c(2,2))
hist(ds225$bmi, main = "Histogram of BMI")
plot(density(ds225$bmi), main = "Density of BMI")
hist(ds225$charges, main = "Histogram of Charges")
plot(density(ds225$charges), main = "Density of Charges")
par(mfrow = c(1,1))
dev.off()
dev.off()
df <- insurence
ds225 <- insurance
#Checking total missing values
sum(is.na(ds225))
#Checking missing values per column
colSums(is.na(ds225))
# Detect outliers for BMI
BMI_outliers <- boxplot.stats(ds225$bmi)$out
BMI_outliers
# Detect outliers for charges
charges_outliers <- boxplot.stats(ds225$charges)$out
charges_outliers
boxplot(ds225$bmi, main = "Boxplot of BMI", ylab = "BMI")
boxplot(ds225$charges, main = "Boxplot of Charges", ylab = "Charges")
#Added new columns to flag outlier rows
ds225$BMI_outlier <- ds225$bmi %in% BMI_outliers
ds225$charges_outlier <- ds225$charges %in% charges_outliers
#Created new datasets without outliers
ds225_no_bmi_outliers <- ds225[!ds225$bmi %in% BMI_outliers, ]
ds225_no_charges_outliers <- ds225[!ds225$charges %in% charges_outliers, ]
#Summary before and after
summary(ds225$bmi)
summary(ds225$charges)
summary(ds225_no_charges_outliers$charges)
#Visual comparison of Box plots
png("Boxplot_of_charges_Outliers.png", width = 800, height = 500)
par(mfrow=c(1,2))
boxplot(ds225$charges, main="Before Removing Outliers", ylab = "Charges")
boxplot(ds225_no_charges_outliers$charges, main="After Removing Outliers", ylab = "Charges")
dev.off()
# Calculate correlation value
correlation_value <- cor(ds225$bmi, ds225$charges, method = "pearson")
correlation_value
# Correlation test
cor.test <- cor.test(ds225$bmi, ds225$charges, method = "pearson")
cor.test
#Histograms for BMI, charges
hist(ds225$bmi,
main = "Histogram of BMI",
xlab = "BMI",
col = "lightblue",
border = "black")
#Histogram for Charges
hist(ds225$charges,
main = "Histogram of Charges",
xlab = "Charges",
col = "lightgreen",
border = "black")
#Denisity plot for BMI
plot(density(ds225$bmi),
main = "Density Plot of BMI",
xlab = "BMI",
ylab = "Density")
#Density plot for Charges
plot(density(ds225$charges),
main = "Density Plot of Charges",
xlab = "Charges",
ylab = "Density")
#Shapiro test for BMI
shapiro.test(ds225$bmi)
#Shapiro test for Charges
shapiro.test(ds225$charges)
#Combined Visualization of Density and Histogram plots for BMI and Charges
png("Combined_visualization.png", width = 800, height = 500)
par(mfrow = c(2,2))
hist(ds225$bmi, main = "Histogram of BMI")
plot(density(ds225$bmi), main = "Density of BMI")
hist(ds225$charges, main = "Histogram of Charges")
plot(density(ds225$charges), main = "Density of Charges")
par(mfrow = c(1,1))
dev.off()
# Scatter plot for BMI vs Charges
png("scatter_bmi_charges.png", width = 800, height = 500)
plot(ds225$bmi, ds225$charges,
main = "Scatterplot: BMI vs Charges",
xlab = "BMI",
ylab = "Charges",
pch = 19,
col = "blue")
abline(lm(charges ~ bmi, data = ds225), col = "red", lwd = 2)
dev.off()
# Select only numeric columns
numeric_df <- df[, c("age", "bmi", "children", "charges")]
library(readr)
insurance <- read_csv("insurance.csv")
View(insurance)
# Select only numeric columns
numeric_df <- df[, c("age", "bmi", "children", "charges")]
# Correlation matrix
cor_matrix <- cor(numeric_df)
# Select only numeric columns
numeric_ds225 <- ds225[, c("age", "bmi", "children", "charges")]
# Correlation matrix
cor_matrix <- cor(numeric_ds225)
cor_matrix
#heatmap
heatmap(cor_matrix, main = "Correlation Heatmap")
library(readr)
insurance <- read_csv("insurance.csv")
View(insurance)
# Load dataset
ds225 <- read.csv("insurance.csv")
# View structure
str(ds225)
# Summary statistics
summary(ds225)
#Checking total missing values
sum(is.na(ds225))
#Checking missing values per column
colSums(is.na(ds225))
# Detect outliers in BMI
BMI_outliers <- boxplot.stats(ds225$bmi)$out
BMI_outliers
# Detect outliers in charges
charges_outliers <- boxplot.stats(ds225$charges)$out
charges_outliers
# Boxplots
boxplot(ds225$bmi, main = "Boxplot of BMI", ylab = "BMI")
boxplot(ds225$charges, main = "Boxplot of Charges", ylab = "Charges")
# Add flag variables
ds225$BMI_outlier <- ds225$bmi %in% BMI_outliers
ds225$charges_outlier <- ds225$charges %in% charges_outliers
# Create cleaned datasets
ds225_no_bmi_out <- ds225[!ds225$bmi %in% BMI_outliers, ]
ds225_no_charge_out <- ds225[!ds225$charges %in% charges_outliers, ]
#Created new datasets without outliers
ds225_no_bmi_outliers <- ds225[!ds225$bmi %in% BMI_outliers, ]
ds225_no_charges_outliers <- ds225[!ds225$charges %in% charges_outliers, ]
#Summary before and after
summary(ds225$bmi)
summary(ds225$charges)
summary(ds225_no_charges_outliers$charges)
# Convert categorical variables for correlation
ds225$smoker_num <- ifelse(ds225$smoker == "yes", 1, 0)
ds225$sex_num <- ifelse(ds225$sex == "male", 1, 0)
ds225$region_num <- as.numeric(as.factor(ds225$region))
# Select numeric columns only
numeric_ds225 <- ds225[, c("age", "bmi", "children", "smoker_num", "sex_num", "region_num", "charges")]
# Compute correlation matrix
cor_matrix <- cor(numeric_ds225)
# Display matrix
cor_matrix
# Load dataset
ds225 <- read.csv("insurance.csv")
# View structure
str(ds225)
# Summary statistics
summary(ds225)
#Checking total missing values
sum(is.na(ds225))
#Checking missing values per column
colSums(is.na(ds225))
# Detect outliers in BMI
BMI_outliers <- boxplot.stats(ds225$bmi)$out
BMI_outliers
# Detect outliers in charges
charges_outliers <- boxplot.stats(ds225$charges)$out
charges_outliers
# Boxplots
boxplot(ds225$bmi, main = "Boxplot of BMI", ylab = "BMI")
boxplot(ds225$charges, main = "Boxplot of Charges", ylab = "Charges")
# Add flag variables
ds225$BMI_outlier <- ds225$bmi %in% BMI_outliers
ds225$charges_outlier <- ds225$charges %in% charges_outliers
# Create cleaned datasets
ds225_no_bmi_out <- ds225[!ds225$bmi %in% BMI_outliers, ]
ds225_no_charge_out <- ds225[!ds225$charges %in% charges_outliers, ]
#Created new datasets without outliers
ds225_no_bmi_outliers <- ds225[!ds225$bmi %in% BMI_outliers, ]
ds225_no_charges_outliers <- ds225[!ds225$charges %in% charges_outliers, ]
#Summary before and after
summary(ds225$bmi)
summary(ds225$charges)
summary(ds225_no_charges_outliers$charges)
# Convert categorical variables for correlation
ds225$smoker_num <- ifelse(ds225$smoker == "yes", 1, 0)
ds225$sex_num <- ifelse(ds225$sex == "male", 1, 0)
ds225$region_num <- as.numeric(as.factor(ds225$region))
# Select numeric columns only
numeric_ds225 <- ds225[, c("age", "bmi", "children", "smoker_num", "sex_num", "region_num", "charges")]
# Compute correlation matrix
cor_matrix <- cor(numeric_ds225)
# Display matrix
cor_matrix
# BMI vs charges
cor(ds225$bmi, ds225$charges)
# Age vs charges
cor(ds225$age, ds225$charges)
# Smoker vs charges (numeric)
cor(ds225$smoker_num, ds225$charges)
# Children vs charges
cor(ds225$children, ds225$charges)
# BMI vs Charges
png("scatter_bmi_charges.png", width = 800, height = 500)
plot(ds225$bmi, ds225$charges,
main = "Scatterplot: BMI vs Charges",
xlab = "BMI",
ylab = "Charges",
pch = 19,
col = "blue")
dev.off()
# Age vs Charges
png("scatter_age_charges.png", width = 800, height = 500)
plot(ds225$age, ds225$charges,
main = "Scatterplot: Age vs Charges",
xlab = "Age",
ylab = "Charges",
col = "green")
dev.off()
# Children vs Charges
png("scatter_children_charges.png", width = 800, height = 500)
plot(ds225$age, ds225$charges,
main = "Scatterplot: Children vs Charges",
xlab = "Children",
ylab = "Charges",
col = "purple")
dev.off()
# Load dataset
ds225 <- read.csv("insurance.csv")
# View structure
str(ds225)
# Summary statistics
summary(ds225)
#Checking total missing values
sum(is.na(ds225))
#Checking missing values per column
colSums(is.na(ds225))
# Detect outliers in BMI
BMI_outliers <- boxplot.stats(ds225$bmi)$out
BMI_outliers
# Detect outliers in charges
charges_outliers <- boxplot.stats(ds225$charges)$out
charges_outliers
# Boxplots
boxplot(ds225$bmi, main = "Boxplot of BMI", ylab = "BMI")
boxplot(ds225$charges, main = "Boxplot of Charges", ylab = "Charges")
# Add flag variables
ds225$BMI_outlier <- ds225$bmi %in% BMI_outliers
ds225$charges_outlier <- ds225$charges %in% charges_outliers
# Create cleaned datasets
ds225_no_bmi_out <- ds225[!ds225$bmi %in% BMI_outliers, ]
ds225_no_charge_out <- ds225[!ds225$charges %in% charges_outliers, ]
#Created new datasets without outliers
ds225_no_bmi_outliers <- ds225[!ds225$bmi %in% BMI_outliers, ]
ds225_no_charges_outliers <- ds225[!ds225$charges %in% charges_outliers, ]
#Summary before and after
summary(ds225$bmi)
summary(ds225$charges)
summary(ds225_no_charges_outliers$charges)
# Convert categorical variables for correlation
ds225$smoker_num <- ifelse(ds225$smoker == "yes", 1, 0)
ds225$sex_num <- ifelse(ds225$sex == "male", 1, 0)
ds225$region_num <- as.numeric(as.factor(ds225$region))
# Select numeric columns only
numeric_ds225 <- ds225[, c("age", "bmi", "children", "smoker_num", "sex_num", "region_num", "charges")]
# Compute correlation matrix
cor_matrix <- cor(numeric_ds225)
# Display matrix
cor_matrix
# BMI vs charges
cor(ds225$bmi, ds225$charges)
# Age vs charges
cor(ds225$age, ds225$charges)
# Smoker vs charges (numeric)
cor(ds225$smoker_num, ds225$charges)
# Children vs charges
cor(ds225$children, ds225$charges)
# BMI vs Charges
png("scatter_bmi_charges.png", width = 1920, height = 1080, res = 150)
plot(ds225$bmi, ds225$charges,
main = "Scatterplot: BMI vs Charges",
xlab = "BMI",
ylab = "Charges",
pch = 19,
col = "blue")
abline(lm(bmi ~ charges, data = ds225), col = "red", lwd = 2)
dev.off()
# Age vs Charges
png("scatter_age_charges.png", width = 1920, height = 1080, res = 150)
plot(ds225$age, ds225$charges,
main = "Scatterplot: Age vs Charges",
xlab = "Age",
ylab = "Charges",
col = "green")
abline(lm(age ~ charges, data = ds225), col = "red", lwd = 2)
dev.off()
# Children vs Charges
png("scatter_children_charges.png", width = 1920, height = 1080, res = 150 )
plot(ds225$age, ds225$charges,
main = "Scatterplot: Children vs Charges",
xlab = "Children",
ylab = "Charges",
col = "purple")
abline(lm(children ~ charges, data = ds225), col = "red", lwd = 2)
dev.off()
plot(ds225$bmi, ds225$charges,
main = "Scatterplot: BMI vs Charges",
xlab = "BMI",
ylab = "Charges",
pch = 19,
col = "blue")
abline(lm(bmi ~ charges, data = ds225), col = "red", lwd = 2)
# BMI vs Charges
png("scatter_bmi_charges.png", width = 800, height = 1080, res = 150)
# BMI vs Charges
png("scatter_bmi_charges.png", width = 800, height = 500, res = 150)
plot(ds225$bmi, ds225$charges,
main = "Scatterplot: BMI vs Charges",
xlab = "BMI",
ylab = "Charges",
pch = 19,
col = "blue")
abline(lm(bmi ~ charges, data = ds225), col = "red", lwd = 2)
dev.off()
